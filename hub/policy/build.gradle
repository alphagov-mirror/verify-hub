dependencies {
    testCompile configurations.test_deps_compile,
            configurations.ida_test_utils,
            configurations.saml,
            'nl.jqno.equalsverifier:equalsverifier:2.4.5'

    compile configurations.ida_utils,
            configurations.verify_event_emitter,
            configurations.common,
            configurations.dropwizard,
            configurations.redisson
}

apply plugin: 'application'
ext.mainclass = 'uk.gov.ida.hub.policy.PolicyApplication'
mainClassName = ext.mainclass

task copyToLib(dependsOn: jar, type: Copy) {
    into "$buildDir/output/lib"
    from configurations.runtime
}

task zip(dependsOn: copyToLib, type: Zip) {
    from "$buildDir/output"
}

apply from: "${rootDir}/inttest.gradle"
apply from: "${rootDir}/shared.gradle"

tasks.check.dependsOn(intTest)
